<!DOCTYPE html> 
<html> 
    <head> 
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <title>Wonder Alien</title>
        <!-- JQuery library-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
        <!-- Popper JS -->
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
        <!-- Latest compiled JavaScript -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
        <!-- JQuery Cookie -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" integrity="sha512-3j3VU6WC5rPQB4Ld1jnLV7Kd5xr+cq9avvhwqzbH/taCRNURoeEpoPBK9pDyeukwSxwRPJ8fDgvYXd6SkaZ2TA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <!-- Para Google One Tap -->
        <script src="https://accounts.google.com/gsi/client" async defer></script> 
        <!-- Socket.io -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.8.1/socket.io.js" integrity="sha512-8BHxHDLsOHx+flIrQ0DrZcea7MkHqRU5GbTHmbdzMRnAaoCIkZ97PqZcXJkKZckMMhqfoeaJE+DNUVuyoQsO3Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <!-- Phaser.js -->
        <script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.js"></script>
        <!-- Estilos personalizados -->
        <link rel="stylesheet" href="./cliente/estilos.css">
        <link rel="icon" href="./cliente/assets/images/hud_player_yellow.png" sizes="48x48">
    </head> 
    <body> 
        <div 
        id="g_id_onload" 
        data-client_id="PLACEHOLDER_CLIENT_ID"
        data-login_uri="PLACEHOLDER_LOGIN_URI" 
        data-skip_prompt_cookie="nick" 
        ></div>

        <!-- Navbar transparente -->
        <nav class="navbar navbar-expand-sm navbar-dark navbar-custom" id="mainNavbar" style="display: none;">
            <!-- Links -->
            <ul class="navbar-nav ml-auto w-100 justify-content-end align-items-center">
                <li class="nav-item mr-3">
                    <span id="nombreUsuario" class="navbar-text"></span>
                </li>
                <li class="nav-item">
                    <button class="btn btn-primary" id="linkSalir">
                        Cerrar Sesión
                    </button>
                </li>
            </ul>
        </nav>

        <!-- Modal de Login/Registro (moved outside #mainContent so backdrop stacks correctly) -->
        <div class="modal fade" id="modalLogin" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="tituloModal"><img src="./cliente/assets/images/hud_player_yellow.png" alt="Player" class="icon-hud"> Wonder Alien - Inicio de Sesión</h5>
                    </div>
                    <div class="modal-body">
                        <div id="notificacionesModal"></div>
                        
                        <!-- Botón de Google Sign-In -->
                        <div class="mb-3 text-center" id="googleSignInContainer">
                            <div id="g_id_signin" 
                                 data-type="standard"
                                 data-size="large"
                                 data-theme="outline"
                                 data-text="signin_with"
                                 data-shape="rectangular"
                                 data-logo_alignment="left"
                                 data-width="280"
                                 data-client_id="PLACEHOLDER_CLIENT_ID"
                                 data-login_uri="PLACEHOLDER_LOGIN_URI">
                            </div>
                        </div>
                        <hr id="separadorAuth">
                        
                        <!-- Contenedor dinámico para login o registro -->
                        <div id="contenedorFormulario"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="mainContent" class="custom-bg">

        <!-- Mensaje de bienvenida temporal -->
        <div id="mensajeBienvenida" class="mensaje-bienvenida" style="display: none;"></div>

        <div class="container-fluid">
            <div id="mensajes"></div>
            <div id="notificaciones"></div>
            
            <!-- Pantalla de bienvenida con botón de jugar (solo visible después del login) -->
            <div id="pantallaInicio" class="contenedor-central" style="display: none;">
                <button class="btn-jugar" id="btnJugar">
                    <img src="./cliente/assets/images/hud_player_yellow.png" alt="Player">
                    JUGAR
                </button>
            </div>

            <!-- Sección Partidas (oculta inicialmente) -->
            <div id="seccionPartidas" class="fondo-partidas" style="display:none;">
                <div class="container">
                    <h2 class="text-center mb-4 mt-4 titulo-partidas"><img src="./cliente/assets/images/hud_player_yellow.png" alt="Player" class="icon-hud"> Partidas Multijugador</h2>
                
                    <!-- Cards de crear/unirse -->
                    <div id="cardsPartidas">
                        <!-- Card para crear partida (centrado) -->
                        <div class="row justify-content-center mb-4">
                            <div class="col-md-6 col-lg-5">
                                <div class="card card-partida">
                                    <div class="card-body text-center py-4">
                                        <h5 class="mb-3">Crear Nueva Partida</h5>
                                        <p class="text-muted mb-3">Crea una partida y espera a que otro jugador se una.</p>
                                        <button id="btnCrearPartida" class="btn btn-success btn-lg btn-block">Crear Partida</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Sección de partidas disponibles -->
                        <div class="row justify-content-center">
                            <div class="col-md-8 col-lg-7">
                                <div class="card card-partida">
                                    <div class="card-header bg-info text-white text-center">
                                        <h5 class="mb-0">Partidas Disponibles</h5>
                                    </div>
                                    <div class="card-body">
                                        <div id="listaPartidas"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Estado de partida actual (oculto inicialmente) -->
                    <div id="estadoPartidaActual" class="mt-4" style="display:none;">
                        <div class="card card-partida">
                            <div class="card-body">
                                <div id="estadoPartida"></div>
                                <button id="btnAbandonarPartida" class="btn btn-danger mt-3">Abandonar Partida</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Contenedor del juego Phaser (oculto inicialmente) -->
                    <div id="juegoContainer" style="display:none;">
                        <div class="card">
                            <div class="card-header bg-success text-white">
                                <h4><img src="./cliente/assets/images/hud_player_yellow.png" alt="Player" class="icon-hud"> Mario Bros 2D - Partida en curso</h4>
                            </div>
                            <div class="card-body text-center">
                                <div id="game"></div>
                                <button id="btnSalirJuego" class="btn btn-danger mt-3">Salir del Juego</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sprites de personajes en el fondo -->
                    <img src="./cliente/assets/images/character_pink_jump_double.png" alt="Pink Character" class="sprite-character sprite-left">
                    <img src="./cliente/assets/images/character_yellow_idle_left_double.png" alt="Yellow Character" class="sprite-character sprite-right">
                </div>
            </div>

            <!-- Sección Acciones (eliminada, no es necesaria para el nuevo diseño) -->
        </div>


        </div>

        <script src="./cliente/clienteRest.js"></script>
        <script src="./cliente/clienteWS.js"></script>
        <!-- Entidades del juego -->
        <script src="./cliente/entidades/Jugador.js"></script>
        <script src="./cliente/entidades/OtroJugador.js"></script>
        <script src="./cliente/entidades/Moneda.js"></script>
        <script src="./cliente/entidades/Bloque.js"></script>
        <script src="./cliente/entidades/BloqueRompible.js"></script>
        <script src="./cliente/entidades/BloquePregunta.js"></script>
        <script src="./cliente/entidades/Goomba.js"></script>
        <script src="./cliente/entidades/Koopa.js"></script>
        <script src="./cliente/entidades/Caparazon.js"></script>
        <script src="./cliente/entidades/Champinon.js"></script>
        <script src="./cliente/entidades/Tuberia.js"></script>
        <script src="./cliente/entidades/PlantaPirana.js"></script>
        <script src="./cliente/entidades/Bandera.js"></script>
        <!-- Juego principal -->
        <script src="./cliente/juego.js"></script>
        <script src="./cliente/controlWeb.js"></script>

        <script>
            rest=new ClienteRest();
            ws=new ClienteWS();
            let juego; // Variable global para la instancia del juego
            cw=new ControlWeb();
            
            // Inicializar la aplicación
            cw.inicializar();
        </script>
    </body> 
</html> 